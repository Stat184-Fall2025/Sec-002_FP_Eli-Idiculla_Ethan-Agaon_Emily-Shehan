# ---- View Raw Data ----
view(CPIHistoricalForecast)

# ---- Load Packages ----
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(lubridate)
library(readxl)
library(janitor)


cpi_tidy <- CPIHistoricalForecast %>%  # Tidying the datset to show Consumer Price Index Item (only showing "Meats", "Fruits and vegetables", and "Dairy products"), Year of Forecast, and Forecast Percent Change
  clean_names() %>% 
  # use only mid-point forecasts
  filter(attribute == "Mid point of prediction interval") %>% 
  # keep only the desired CPI items
  filter(
    consumer_price_index_item %in% c(
      "Meats",
      "Fruits and vegetables",
      "Dairy products"
    )
  ) %>%
  select(
    consumer_price_index_item,
    year_of_forecast,
    year_being_forecast,
    forecast_percent_change
  )


cpi_tidy # Viewing tidied dataset



# Now making data visualizations

cpi_tidy %>%
  filter(consumer_price_index_item == "Meats") %>%     # Line plot representing the Forecast Percent Change for meats from 2004 - 2024
  ggplot(aes(x = year_of_forecast,
             y = forecast_percent_change)) +
  geom_line(color = "blue", linewidth = 0.6) +
  labs(
    title = "USDA Forecasted CPI Percent Change: Meats",
    x = "Year",
    y = "Forecast Percent Change (%)"
  ) +
  theme_minimal()


cpi_tidy %>%
  filter(consumer_price_index_item == "Fruits and vegetables") %>%     # Line plot representing the Forecast Percent Change for fruits and vegetables from 2004 - 2024
  ggplot(aes(x = year_of_forecast,
             y = forecast_percent_change)) +
  geom_line(color = "blue", linewidth = 0.6) +
  labs(
    title = "USDA Forecasted CPI Percent Change: Fruits and vegetables",
    x = "Year",
    y = "Forecast Percent Change (%)"
  ) +
  theme_minimal()

cpi_tidy %>%
  filter(consumer_price_index_item == "Dairy products") %>%    
  ggplot(aes(x = year_of_forecast,
             y = forecast_percent_change)) +
  geom_line(color = "blue", linewidth = 0.6) +
  labs(
    title = "USDA Forecasted CPI Percent Change: Dairy Products",
    x = "Year",
    y = "Forecast Percent Change (%)"
  ) +
  theme_minimal()


